# E. Thief in a a Shop - é¢˜è§£

### æ¯”èµ›ä¸æ ‡ç­¾
> **æ¯”èµ›**: Educational Codeforces Round 9
> **æ ‡ç­¾**: divide and conquer, dp, fft, math
> **éš¾åº¦**: *2400

## é¢˜ç›®å¤§æ„å–µ~
æœ‰ä¸€ä½å°å·å…ˆç”Ÿè¦å»å•†åº—â€œè¿›è´§â€å•¦ï¼ä»–æœ‰ä¸€ä¸ªç¥å¥‡çš„èƒŒåŒ…ï¼Œæ­£å¥½èƒ½è£…ä¸‹ `k` ä»¶ç‰©å“ã€‚å•†åº—é‡Œæœ‰ `n` ç§å•†å“ï¼Œæ¯ç§å•†å“éƒ½æœ‰æ— é™ä»¶ï¼Œç¬¬ `i` ç§å•†å“çš„ä»·å€¼æ˜¯ `a_i`ã€‚

è¿™ä½å°å·å…ˆç”Ÿéå¸¸è´ªå¿ƒï¼ˆä¹Ÿå¾ˆè®²ç©¶ï¼ï¼‰ï¼Œä»–ä¸å¤šä¸å°‘ï¼Œä¸€å®šä¼šæ‹¿èµ°**æ°å¥½ `k` ä»¶**å•†å“ã€‚ä»–å¯ä»¥æ‹¿å¤šä»¶åŒç§ç±»çš„å•†å“å“¦ã€‚

ç°åœ¨ï¼Œè¯·ä½ å¸®ä»–ç®—ä¸€ç®—ï¼Œä»–æ‹¿èµ°çš„è¿™ `k` ä»¶å•†å“ï¼Œæ‰€æœ‰å¯èƒ½çš„æ€»ä»·å€¼æ˜¯å¤šå°‘å‘¢ï¼ŸæŠŠè¿™äº›å¯èƒ½çš„æ€»ä»·å€¼æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºè¾“å‡ºå°±å¯ä»¥å•¦ï¼Œå–µ~

**è¾“å…¥æ ¼å¼**:
- ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ•´æ•° `n` å’Œ `k`ã€‚
- ç¬¬äºŒè¡Œæ˜¯ `n` ä¸ªæ•´æ•° `a_i`ï¼Œä»£è¡¨æ¯ç§å•†å“çš„ä»·å€¼ã€‚

**è¾“å‡ºæ ¼å¼**:
- ä¸€è¡Œï¼Œæ‰€æœ‰å¯èƒ½çš„æ€»ä»·å€¼ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œå¹¶æŒ‰å‡åºæ’åˆ—ã€‚

## è§£é¢˜æ€è·¯ï¼Œæ¥ä¸€èµ·æ¢é™©å§ï¼
çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¤§å®¶çš„ç¬¬ä¸€ååº”æ˜¯ä¸æ˜¯ç»å…¸çš„åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œ`dp[i][j]` è¡¨ç¤ºæ‹¿ `i` ä»¶ç‰©å“èƒ½å¦å‡‘å‡ºæ€»ä»·å€¼ `j`ã€‚ä½†æ˜¯æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹æ•°æ®èŒƒå›´ï¼š`k` å’Œ `a_i` éƒ½æ˜¯ 1000ï¼Œé‚£ä¹ˆæ€»ä»·å€¼æœ€é«˜å¯ä»¥è¾¾åˆ° `k * max(a_i) = 1000 * 1000 = 10^6`ã€‚DPçš„çŠ¶æ€æ•°é‡ä¼šæ˜¯ `k * (k * max(a_i))`ï¼Œè¿™å®åœ¨æ˜¯å¤ªå¤§äº†ï¼Œä¼šè¶…æ—¶è¶…åˆ°å¤©ä¸Šå»çš„ï¼Œä¸è¡Œä¸è¡Œï¼(>Ï‰<)

é‚£ä¹ˆï¼Œæˆ‘ä»¬å¾—æ¢ä¸ªæ€è·¯å•¦ï¼è¿™ç§â€œæ±‚è‹¥å¹²ä¸ªæ•°ç›¸åŠ èƒ½å‡‘å‡ºçš„æ‰€æœ‰å’Œâ€çš„é—®é¢˜ï¼Œæœ‰ä¸€ä¸ªè¶…çº§å‰å®³çš„æ­¦å™¨â€”â€”**ç”Ÿæˆå‡½æ•° (Generating Function)**ï¼Œä¹Ÿå«æ¯å‡½æ•°ï¼

#### 1. ç”Ÿæˆå‡½æ•°çš„é­”æ³• âœ¨

è®©æˆ‘ä»¬æŠŠæ¯ç§å•†å“çš„é€‰æ‹©çœ‹ä½œä¸€ä¸ªå¤šé¡¹å¼ã€‚å¯¹äºä¸€ç§ä»·å€¼ä¸º `c` çš„å•†å“ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ `x^c` è¿™ä¸€é¡¹æ¥ä»£è¡¨å®ƒã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä»·å€¼ä¸º `a_1, a_2, ..., a_n` çš„å•†å“ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªâ€œé€‰æ‹©å¤šé¡¹å¼â€ `P(x)`ï¼š

`P(x) = x^{a_1} + x^{a_2} + ... + x^{a_n}`

è¿™ä¸ªå¤šé¡¹å¼ä»£è¡¨äº†æˆ‘ä»¬**æ‹¿ä¸€ä»¶å•†å“**çš„æ‰€æœ‰å¯èƒ½æ€§ã€‚`x` çš„æŒ‡æ•°å°±ä»£è¡¨äº†è¿™ä»¶å•†å“çš„ä»·å€¼ã€‚

é‚£å¦‚æœæˆ‘ä»¬**æ‹¿ä¸¤ä»¶**å‘¢ï¼Ÿæ¯”å¦‚æˆ‘ä»¬æ‹¿äº†ä»·å€¼ä¸º `a_i` å’Œ `a_j` çš„ä¸¤ä»¶å•†å“ï¼Œæ€»ä»·å€¼å°±æ˜¯ `a_i + a_j`ã€‚åœ¨å¤šé¡¹å¼é‡Œï¼Œè¿™å¯¹åº”ç€ `x^{a_i} * x^{a_j} = x^{a_i + a_j}`ã€‚

æ‰€ä»¥ï¼Œè¦å¾—åˆ°æ‹¿ä¸¤ä»¶å•†å“æ‰€æœ‰å¯èƒ½çš„æ€»ä»·å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®— `P(x) * P(x) = P(x)^2`ï¼å±•å¼€åçš„å¤šé¡¹å¼ä¸­ï¼Œæ‰€æœ‰ `x` çš„æŒ‡æ•°å°±æ˜¯æ‰€æœ‰å¯èƒ½çš„æ€»ä»·å€¼å’Œã€‚

ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬è¦æ‹¿ `k` ä»¶å•†å“ï¼Œé‚£ä¸å°±æ˜¯è®¡ç®— `P(x)^k` å—ï¼Ÿæœ€åï¼Œæˆ‘ä»¬åªè¦çœ‹çœ‹ `P(x)^k` è¿™ä¸ªå¤šé¡¹å¼é‡Œï¼Œå“ªäº›é¡¹çš„ç³»æ•°ä¸ä¸ºé›¶ï¼Œè¿™äº›é¡¹çš„æŒ‡æ•°å°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„ç­”æ¡ˆå•¦ï¼æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ï¼Œå–µï¼Ÿ

#### 2. åŠ é€Ÿï¼FFT å†²å‘€ï¼ğŸš€

ç›´æ¥è®¡ç®—å¤šé¡¹å¼ä¹˜æ³•è¿˜æ˜¯å¾ˆæ…¢çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æœ‰ **å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ (Fast Fourier Transform, FFT)** è¿™ä¸ªå¤§æ€å™¨ï¼FFT å¯ä»¥åœ¨ `O(N log N)` çš„æ—¶é—´å†…å®Œæˆä¸¤ä¸ª `N` æ¬¡å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œå…¶ä¸­ `N` æ˜¯ç»“æœå¤šé¡¹å¼çš„æœ€é«˜æ¬¡æ•°ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„è®¡åˆ’æ˜¯ï¼š
1.  æ„é€ åˆå§‹å¤šé¡¹å¼ `P(x)`ã€‚
2.  ä½¿ç”¨**å¿«é€Ÿå¹‚ï¼ˆä¹Ÿå«äºŒè¿›åˆ¶å¹‚ï¼‰** çš„æ€æƒ³æ¥è®¡ç®— `P(x)^k`ã€‚è¿™éœ€è¦ `O(log k)` æ¬¡å¤šé¡¹å¼ä¹˜æ³•ã€‚
3.  æ¯æ¬¡å¤šé¡¹å¼ä¹˜æ³•éƒ½ç”¨ FFT æ¥åŠ é€Ÿã€‚

#### 3. ä¸€ä¸ªå°å°çš„ä¼˜åŒ–æŠ€å·§ ğŸ¾

ç›´æ¥ç”¨ `a_i` æ¥æ„é€ å¤šé¡¹å¼ï¼Œæœ€é«˜æ¬¡ä¼šè¾¾åˆ° `k * max(a_i)`ï¼Œå¤§çº¦æ˜¯ `10^6`ã€‚è™½ç„¶å¯è¡Œï¼Œä½†æˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ï¼

æ³¨æ„åˆ°ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ‰€æœ‰å•†å“çš„ä»·æ ¼éƒ½å‡å»åŒä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚æœ€å°ä»·æ ¼ `min_a`ï¼Œé‚£ä¹ˆæ€»ä»·æ ¼çš„ç›¸å¯¹å…³ç³»æ˜¯ä¸å˜çš„ã€‚
å‡è®¾æˆ‘ä»¬æ‹¿äº† `k` ä»¶å•†å“ï¼Œå®ƒä»¬çš„åŸå§‹ä»·æ ¼æ˜¯ `c_1, c_2, ..., c_k`ã€‚
æ€»ä»· `S = c_1 + c_2 + ... + c_k`ã€‚
å¦‚æœæˆ‘ä»¬æŠŠæ¯ä¸ªä»·æ ¼éƒ½å‡å» `min_a`ï¼Œå¾—åˆ°æ–°ä»·æ ¼ `b_i = c_i - min_a`ã€‚
é‚£ä¹ˆæ–°çš„æ€»ä»· `S' = b_1 + b_2 + ... + b_k = (c_1 - min_a) + ... + (c_k - min_a) = S - k * min_a`ã€‚
æ‰€ä»¥ `S = S' + k * min_a`ã€‚

è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨å˜æ¢åçš„ä»·æ ¼ `b_i = a_i - min_a` æ¥è§£å†³é—®é¢˜ï¼Œæ±‚å‡ºæ‰€æœ‰å¯èƒ½çš„æ–°æ€»ä»· `S'`ï¼Œæœ€åå†ç»™æ¯ä¸ª `S'` åŠ ä¸Š `k * min_a` å°±å¥½å•¦ï¼

è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ–°çš„ä»·æ ¼ `b_i` ä» 0 å¼€å§‹ï¼Œæœ€å¤§å€¼ä¹Ÿå˜å°äº† (`max(a_i) - min(a_i)`)ï¼Œå¤šé¡¹å¼çš„æœ€é«˜æ¬¡ä¹Ÿç›¸åº”å‡å°ï¼Œè®¡ç®—èµ·æ¥æ›´èˆ’æœ~

#### æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„æœ€ç»ˆæ–¹æ¡ˆï¼š
1.  è¯»å…¥æ‰€æœ‰ä»·æ ¼ `a_i`ï¼Œå»é‡å¹¶æ’åºã€‚
2.  æ‰¾åˆ°æœ€å°ä»·æ ¼ `min_a`ã€‚
3.  å°†æ‰€æœ‰ä»·æ ¼ `a_i` è½¬åŒ–ä¸º `b_i = a_i - min_a`ã€‚
4.  æ ¹æ® `b_i` æ„é€ ä¸€ä¸ª 01 ç³»æ•°çš„å¤šé¡¹å¼ `P(x)`ï¼Œå¦‚æœ `v` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ `b_i` å€¼ï¼Œé‚£ä¹ˆ `P(x)` ä¸­ `x^v` çš„ç³»æ•°ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚
5.  ä½¿ç”¨ FFT å’Œå¿«é€Ÿå¹‚è®¡ç®—å‡ºç»“æœå¤šé¡¹å¼ `R(x) = P(x)^k`ã€‚
6.  éå† `R(x)` çš„ç³»æ•°ã€‚å¦‚æœ `x^i` çš„ç³»æ•°å¤§äº 0ï¼Œè¯´æ˜ `i` æ˜¯ä¸€ä¸ªå¯èƒ½çš„â€œæ–°æ€»ä»·â€ï¼Œé‚£ä¹ˆ `i + k * min_a` å°±æ˜¯ä¸€ä¸ªæœ€ç»ˆç­”æ¡ˆï¼

å¥½å•¦ï¼Œæ€è·¯æ¸…æ™°äº†ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»£ç æ˜¯æ€ä¹ˆå®ç°çš„å§ï¼

## ä»£ç å®ç°ï¼Œä¸€èµ·æ¥æ•²ä»£ç å–µï¼
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#include <complex>
#include <cmath>

// å¿«é€Ÿ I/Oï¼Œè®©ç¨‹åºè·‘å¾—åƒçŒ«ä¸€æ ·å¿«ï¼
void fast_io() {
    std::ios_base::sync_with_stdio(false);
    std::cin.tie(nullptr);
}

// å®šä¹‰å¤æ•°ç±»å‹ï¼ŒFFT çš„åŸºç¡€å–µ
using base = std::complex<double>;
const double PI = acos(-1.0);

// FFT æ ¸å¿ƒå‡½æ•°ï¼Œå®ç°å¤šé¡¹å¼ä»ç³»æ•°è¡¨ç¤ºåˆ°ç‚¹å€¼è¡¨ç¤ºçš„è½¬æ¢ï¼ˆä»¥åŠé€†è½¬æ¢ï¼‰
void fft(std::vector<base>& a, bool invert) {
    int n = a.size();
    if (n <= 1) return;

    // è´è¶å˜æ¢å‰çš„â€œä½é€†åºç½®æ¢â€ï¼Œè®©æ•°æ®æ’å¥½é˜Ÿ~
    for (int i = 1, j = 0; i < n; i++) {
        int bit = n >> 1;
        for (; j & bit; bit >>= 1)
            j ^= bit;
        j ^= bit;
        if (i < j)
            std::swap(a[i], a[j]);
    }

    // ä»åº•å±‚å‘ä¸Šï¼Œä¸€å±‚å±‚è¿›è¡Œè¶å½¢è¿ç®—
    for (int len = 2; len <= n; len <<= 1) {
        double ang = 2 * PI / len * (invert ? -1 : 1); // æ ¹æ®æ­£å‘æˆ–é€†å‘FFTè®¡ç®—å•ä½æ ¹
        base wlen(cos(ang), sin(ang));
        for (int i = 0; i < n; i += len) {
            base w(1);
            for (int j = 0; j < len / 2; j++) {
                base u = a[i + j];
                base v = a[i + j + len / 2] * w;
                a[i + j] = u + v;
                a[i + j + len / 2] = u - v;
                w *= wlen;
            }
        }
    }

    // å¦‚æœæ˜¯é€†FFT (IFFT)ï¼Œéœ€è¦å°†ç»“æœé™¤ä»¥ n
    if (invert) {
        for (base& x : a) {
            x /= n;
        }
    }
}

// ä½¿ç”¨ FFT åŠ é€Ÿçš„å¤šé¡¹å¼ä¹˜æ³•
std::vector<long long> multiply(const std::vector<long long>& a, const std::vector<long long>& b) {
    if (a.empty() || b.empty()) {
        return {};
    }
    std::vector<base> fa(a.begin(), a.end()), fb(b.begin(), b.end());
    int n = 1;
    // è®¡ç®—FFTéœ€è¦çš„é•¿åº¦ï¼Œå¿…é¡»æ˜¯2çš„å¹‚ä¸”å¤§äºç­‰äºç»“æœå¤šé¡¹å¼çš„é¡¹æ•°
    while (n < a.size() + b.size() - 1) n <<= 1;
    fa.resize(n);
    fb.resize(n);

    // 1. æ­£å‘ FFT
    fft(fa, false);
    fft(fb, false);

    // 2. ç‚¹å€¼ç›¸ä¹˜
    for (int i = 0; i < n; i++) {
        fa[i] *= fb[i];
    }
    
    // 3. é€†å‘ FFT
    fft(fa, true);

    std::vector<long long> result(a.size() + b.size() - 1);
    for (size_t i = 0; i < result.size(); i++) {
        // ç”±äºæµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜ï¼Œéœ€è¦å››èˆäº”å…¥å–æ•´
        result[i] = round(fa[i].real());
    }
    return result;
}

// å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼Œè®¡ç®— p(x)^exp
std::vector<long long> poly_pow(std::vector<long long> p, int exp) {
    std::vector<long long> res = {1}; // ç»“æœåˆå§‹åŒ–ä¸º p(x)^0 = 1
    while (exp > 0) {
        if (exp % 2 == 1) {
            res = multiply(res, p);
            // ä¼˜åŒ–ï¼šæˆ‘ä»¬åªå…³å¿ƒæŸä¸ªä»·å€¼æ˜¯å¦å¯èƒ½å‡‘å‡ºï¼Œä¸å…³å¿ƒæœ‰å¤šå°‘ç§æ–¹æ³•
            // æ‰€ä»¥ç³»æ•°å¤§äº0çš„éƒ½è®¾ä¸º1ï¼Œå¯ä»¥é˜²æ­¢æ•°å€¼è¿‡å¤§å’Œå‡å°ç²¾åº¦è¯¯å·®
            for(auto& val : res) if (val > 0) val = 1;
        }
        if (exp > 1) {
            p = multiply(p, p);
            for(auto& val : p) if (val > 0) val = 1;
        }
        exp /= 2;
    }
    return res;
}

int main() {
    fast_io();

    int n, k;
    std::cin >> n >> k;

    std::vector<int> a(n);
    for (int i = 0; i < n; ++i) {
        std::cin >> a[i];
    }
    // é¢„å¤„ç†ï¼šæ’åºå’Œå»é‡
    std::sort(a.begin(), a.end());
    a.erase(std::unique(a.begin(), a.end()), a.end());
    
    // æ‰¾åˆ°æœ€å°ä»·å€¼ï¼Œä¸ºæˆ‘ä»¬çš„ä¼˜åŒ–åšå‡†å¤‡
    int min_a = a[0];

    // è®¡ç®—å¹³ç§»åçš„ä»·å€¼ b_i = a_i - min_a
    std::vector<int> b;
    for (int x : a) {
        b.push_back(x - min_a);
    }
    
    int max_b = 0;
    if (!b.empty()) {
        max_b = b.back();
    }
    
    // æ„é€ åˆå§‹å¤šé¡¹å¼ p(x)ï¼Œp[v] = 1 è¡¨ç¤ºä»·å€¼ v å­˜åœ¨
    std::vector<long long> p(max_b + 1, 0);
    for (int val : b) {
        p[val] = 1;
    }

    // è®¡ç®— p(x)^k
    std::vector<long long> res_poly = poly_pow(p, k);

    // è®¡ç®—åŸºç¡€ä»·å€¼åç§»é‡
    long long base_cost = (long long)k * min_a;
    bool first = true;
    // éå†ç»“æœå¤šé¡¹å¼ï¼Œè¾“å‡ºæ‰€æœ‰å¯èƒ½çš„æ€»ä»·å€¼
    for (size_t i = 0; i < res_poly.size(); ++i) {
        if (res_poly[i] > 0) {
            if (!first) {
                std::cout << " ";
            }
            std::cout << base_cost + i;
            first = false;
        }
    }
    std::cout << std::endl;

    return 0;
}
```

## å¤æ‚åº¦åˆ†æï¼Œçœ‹çœ‹æˆ‘ä»¬è·‘å¾—æœ‰å¤šå¿«ï¼Ÿ
- **æ—¶é—´å¤æ‚åº¦**: O(M log M * log k) çš„è¯´ã€‚
  è¿™é‡Œçš„ `M` æ˜¯æˆ‘ä»¬éœ€è¦å¤„ç†çš„å¤šé¡¹å¼çš„æœ€å¤§é•¿åº¦ï¼Œå®ƒçº¦ç­‰äº `k * (max(a_i) - min(a_i))`ã€‚åœ¨æœ€åæƒ…å†µä¸‹ï¼Œ`M` å¤§çº¦æ˜¯ `1000 * 1000 = 10^6`ã€‚FFT çš„é•¿åº¦ `N` ä¼šæ˜¯å¤§äº `M` çš„æœ€å°çš„ 2 çš„å¹‚ã€‚æ¯ä¸€æ¬¡å¤šé¡¹å¼ä¹˜æ³•çš„æ—¶é—´æ˜¯ `O(N log N)`ã€‚æˆ‘ä»¬ç”¨å¿«é€Ÿå¹‚è®¡ç®— `k` æ¬¡æ–¹ï¼Œéœ€è¦ `O(log k)` æ¬¡ä¹˜æ³•ã€‚æ‰€ä»¥æ€»æ—¶é—´å°±æ˜¯ `O(N log N * log k)` å•¦ï¼å¯¹äºè¿™é“é¢˜çš„æ•°æ®èŒƒå›´ï¼Œå®Œå…¨å¯ä»¥æ¥å—ã€‚

- **ç©ºé—´å¤æ‚åº¦**: O(M) çš„è¯´ã€‚
  æˆ‘ä»¬ä¸»è¦çš„å†…å­˜å¼€é”€åœ¨äºå­˜å‚¨å¤šé¡¹å¼çš„ç³»æ•°å‘é‡ã€‚åœ¨ FFT è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¤§å°ä¸º `N` çš„å‘é‡æ¥å­˜å‚¨ç‚¹å€¼è¡¨ç¤ºã€‚æ‰€ä»¥ç©ºé—´å¤æ‚åº¦å’Œ `N` (ä¹Ÿå°±æ˜¯ `M`) æ˜¯ä¸€ä¸ªæ•°é‡çº§çš„ã€‚

## çŸ¥è¯†ç‚¹ä¸æ€»ç»“ï¼Œè¿™æ¬¡æˆ‘ä»¬æ•è·äº†ä»€ä¹ˆï¼Ÿ
è¿™æ¬¡æ¢é™©çœŸæ˜¯æ”¶è·æ»¡æ»¡å‘€ï¼æˆ‘ä»¬æˆåŠŸæ•è·äº†ä»¥ä¸‹è¿™äº›é—ªé—ªå‘å…‰çš„çŸ¥è¯†ç‚¹ï¼š

1.  **ç”Ÿæˆå‡½æ•°**: è¿™æ˜¯è§£å†³ç»„åˆè®¡æ•°é—®é¢˜çš„è¶…çº§å¤§æ€å™¨ï¼å°†ç»„åˆé—®é¢˜è½¬åŒ–ä¸ºå¤šé¡¹å¼ä»£æ•°é—®é¢˜ï¼Œæ€è·¯éå¸¸å·§å¦™ã€‚ä»¥åé‡åˆ°â€œæ±‚å’Œçš„ç»„åˆâ€è¿™ç±»é—®é¢˜ï¼Œå¯ä»¥å¤šå¾€è¿™ä¸ªæ–¹å‘æƒ³ä¸€æƒ³å“¦ã€‚
2.  **FFT/NTT**: å¿«é€Ÿå‚…é‡Œå¶å˜æ¢æ˜¯å®ç°å¤šé¡¹å¼å¿«é€Ÿä¹˜æ³•çš„æ ¸å¿ƒç®—æ³•ã€‚å®ƒæ˜¯ç®—æ³•ç«èµ›ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å·ç§¯é—®é¢˜æ—¶ã€‚è¿™é‡Œçš„ `NTT` (æ•°è®ºå˜æ¢) æ˜¯ `FFT` åœ¨æ¨¡æ„ä¹‰ä¸‹çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é¿å…æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜ï¼Œä¸è¿‡è¿™é“é¢˜ç”¨ `FFT` å°±è¶³å¤Ÿå•¦ã€‚
3.  **å¿«é€Ÿå¹‚**: ä¸ä»…ä»…èƒ½ç”¨äºæ•°å€¼è®¡ç®—ï¼Œå®ƒçš„æ€æƒ³å¯ä»¥æ¨å¹¿åˆ°ä»»ä½•å…·æœ‰ç»“åˆå¾‹çš„è¿ç®—ä¸Šï¼Œæ¯”å¦‚çŸ©é˜µä¹˜æ³•å’Œæˆ‘ä»¬è¿™é‡Œçš„å¤šé¡¹å¼ä¹˜æ³•ã€‚
4.  **å¹³ç§»æ€æƒ³**: å¯¹æ•°æ®è¿›è¡Œæ•´ä½“å¹³ç§»ï¼ˆæ¯”å¦‚éƒ½å‡å»æœ€å°å€¼ï¼‰æ˜¯ä¸€ç§éå¸¸å®ç”¨çš„ä¼˜åŒ–æŠ€å·§ã€‚å®ƒèƒ½ç®€åŒ–é—®é¢˜ï¼Œç¼©å°æ•°æ®èŒƒå›´ï¼Œè®©è®¡ç®—æ›´é«˜æ•ˆã€‚

å¸Œæœ›è¿™æ¬¡çš„é¢˜è§£èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ FFT å’Œç”Ÿæˆå‡½æ•°çš„é­…åŠ›ï¼ç®—æ³•çš„ä¸–ç•Œå°±åƒä¸€ä¸ªå·¨å¤§çš„æ¸¸ä¹å›­ï¼Œæ€»æœ‰æ–°å¥‡åˆå¥½ç©çš„é¡¹ç›®åœ¨ç­‰ç€æˆ‘ä»¬ã€‚ä¿æŒå¥½å¥‡å¿ƒï¼Œç»§ç»­æ¢ç´¢å§ï¼å–µ~ (à¸…'Ï‰'à¸…)